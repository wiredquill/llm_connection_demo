# Use the same reliable Python base image
FROM python:3.11-slim

# Set the working directory in the container
WORKDIR /app

# Copy the new requirements file into the container
# This file should now contain: requests, Flask, flask-cors
COPY requirements.txt .

# Install Python dependencies
RUN pip install --no-cache-dir -r requirements.txt

# Copy the new Python backend script into the container
# We are now using 'status_backend.py' instead of 'main.py'
COPY ./app/status_backend.py /app/status_backend.py


# REMOVED: The OLLAMA_BASE_URL is no longer needed in this container,
# as its only job is to check external network status. Open WebUI will handle
# the connection to Ollama directly.

# Expose the port the new Flask backend will run on
# Flask runs on port 5000 by default in our script, not Gradio's 7860.
EXPOSE 5000

# Command to run the Flask application
# We are now running the 'status_backend.py' script.
CMD ["python", "-u", "status_backend.py"]